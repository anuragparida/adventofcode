def lvl5bfn():
    import copy

    inp = """..#.....##......#............#..................................#.....#..............#................#.........................#.
    ..........................................................................................................#..........#...#.......#
    ..................#....................#.......................................#.....#....#............#.......#..................
    ......#...#..##....................................................................#...#.......#..........#..#.....#..............
    ..#..#.#.............#.#.........#.........##..................#..............#..........................#........................
    #..........#.................#..........#...............................#..#.................#.......##..##..#.#..................
    ......................#......................................................#........................#......................#....
    ........................#.#.....................................#..............................#.......#.............#.....#......
    #.................#...#......#..........#.......#.....#............................................#...........##.........#.....#.
    ...........................................#.....#............##...............#..............................#...................
    .....#..............#......................................#..........#............#..................##...............#......###.
    ..............#..#.....................................##................#............................#............#......#.......
    #........#...................................................#..........................................#.........................
    .................................................................................#................................#....#..#..#....
    .............................#.###.........#.#...............#..........................................##........................
    ......................................................................................................................#.........#.
    ...............#............#............#...#.........#............#.............................#.#........................#....
    ........................#...............#...............#........#.........#................#....#.#....................#.........
    ........#...............#...........................................................................................#.............
    .................#..........................................................#.....................................................
    ........#.#.#...................#..#.......#...........#..#............#......#.....................#.....#.........#..#..........
    ..#.......#..................................................................................................#......#.............
    ................##...##......................#....................................................#..............................#
    ............#......................................#...........................#.#...#...............#.....................##.....
    ..........#...................#.....................#...........................................##................................
    .#.......................#...............................................................#........................................
    ...................................................................#..#................#.....#....................#...............
    ...........#...........................................................#..........................................................
    .....#....#..#..........................................................#..................#.....................##...............
    ...#................................#.....#...................#...............##...........#..............#.......................
    .......##.....#.............#..#.......................................................................#......................#...
    ......................................#....#.............................................#...#....................#...............
    .......#.......#...............#..#.....#..............................#.#......#...............#.................................
    ......................#.......#.......#..........................................................#................#...........#...
    ..............................#........................#.......#..#...............................#...............................
    ...........................#..........#..##.......................#................#..............................................
    ..............#............#...##........#.................................#................#....#........................#..#....
    ..............#.........#............................................#.............#......#......#.#....#.........................
    .......................#.................................#..#..#..#..............................................#................
    ........................###..#...............................................................#.........#................#......#..
    #........................................................................................#........................................
    ........................................#..............................##.....#.........................#...........#.............
    .............#.........#...#................#..#..........#.....#...........................................................#.....
    .......................................#......#.............................#.........#................#..........................
    ..........................................................#......................#...........#...#.......#........................
    #.....................................#.#...#.............................................................#...........#........#..
    ............................#..................................................................................#............#.....
    #.................#.................................................................#..............#...................#..........
    ........#...................................................................#...............................................#.....
    .................#...#..................#.............................................................#.......#...................
    ...#.....#.................................................................................................#..........#...........
    ..........#...................................#....#................#......#........................................#.......#.....
    .....................................#...............#................................................................#...........
    .#............#................................................................#.............................................#....
    ...........#.........#.....................#...........#^.......................#.....................#..........#................
    .....#........#.................................................................................................#.......#.........
    ..........#..........................#.......#......................#..............................#....#......................#..
    ...#.........................#.................#....#........#....................................................................
    ...............#...#........................................#................................#....#........................#.#....
    ...........#.......................................#......#....#.......................................................#.......#..
    #.........#...............#..#..#..........#..............#...........................#...........#.....................#.........
    ...................#.......................................................#......................................................
    .............#..............................................#.......................................#.........#...........#......#
    ....#......#...#.................................#.....#......#.................................#.................................
    ...............#...............#......................................................................#...........................
    .......................#.........................................................................................................#
    .............................#............................................................................#.......................
    ...................#..#.........#...........................#......#...............#......#.......................................
    ...#....................................#...................#..#...........................#............#...............#........#
    ...................#................................................................#............##...............................
    ........................#.#...................#.....................................................................#...#.........
    ...................#......#.......#.#......................................................#...............#......................
    ....#...........................#................#.............................#..#....................#........##.....#..........
    .........................#......................................................#.#......................................#........
    .........#.............#.................#........................................................................................
    .#.#.......#..#....#.......#...#..#......................................................................#.#......................
    ..#.................#............................................................................#................................
    .#................................#...............................................................................................
    ..........#............#..............................................#...#...............##...............#..................#...
    ................................#.........................#.......................................................................
    ........................................................##.......#........................#.....................#.................
    ......#......................................................#......#.........#........................................#.......#..
    ...........................................................#............#....#......#.............................................
    ..................................#...................................................#.................................#...#.....
    .......#...#..........#............#.......#........................................#..#.................#........................
    ....................#........................................#........#...........................................................
    .................................##..#............#.................................#.............#..................#....#.......
    .#.................#..........#.....#...........#.......................................................#...................#.....
    ........................#.........................................................................................................
    ...#..........................................#...........................#.................................#.....................
    ............#......................................................#.................................#.........#..............#...
    .............#........##.........#..................#...#.............#......#....##................#................#............
    ..................#...........................................................................................#.................#.
    .....................#..#..#....................#........................#.........#................................#.............
    ..............................................#...................#............................#..............................#...
    .......................#.#...................................#.............................#...................................#..
    ................................#...........#.............................#.............#.........#..............................#
    ...........................#................................#...................................................#.....#...........
    ..........#..........#.....#..........#..#............#..........#.................#.......#.......#........................#....#
    ...#.......#...#..............................................................................................#......#......#.....
    ...........#......................#..#.................#......#.........#.....#.............#............##................#....#.
    .......#...........................................#..................#...............#.............................#.............
    ....#.......#.................................#..................................................................#................
    ..#..................................#...#............................#.........#....#..........#............................#....
    ....................................................#.................#...........................................#...............
    ............#......................................#.........#..................#.....#.#.#.#..#..................................
    #..............#.......#...#.#..............#.....#.#.............................................................................
    ...........#.#.................................#...#........................................#................#.........#....#.....
    ......#.........................................#.........................#...........................................#...........
    ...#......#.................................#......#............................................................................#.
    ...#.................#....##................#...........................................#.........#....#..........................
    ...........#...#...#..................#...................................#......................................#......#.....#.#.
    ...................................#....................#................#..................................................#.....
    ................#.....................................#...........#......#........................................................
    ..............................#......#..#..............................................##........#......#......................#.#
    #...........................#....#....##.....#...........................##..#...................#.....#........#.................
    ..........#....#.#..................#..........#..#................#.................#..................................##.......#
    ...................#.....................#......#...........................................................#..........#..........
    ........#.....#.............................#..............................................#......................................
    ......#............#.#.................................................................................................#..#.......
    .#.........#..................................................................................#....#...........#.................#
    ........#.....#.......................#.........................................#...........................................#.....
    ...................#.......#..#......#.................##......................................#...................#..............
    .............................#.................................#........#.......#..................................#.........#....
    ....#....#..........#....###..#...................................................#...#................................#.......#..
    ...................#...................................................#.......#....#........................#....................
    ...#................#...........#.......................#.....................................#...#......#......#.................
    .......#........................#.........#.............................................................#...#...#.................
    ....................#.........#..............................#..........................#....................#..#.................
    ..#..........................#.#...................................#..................#..........#................#..............."""

    # inp = """....#.....
    # .........#
    # ..........
    # ..#.......
    # .......#..
    # ..........
    # .#..^.....
    # ........#.
    # #.........
    # ......#..."""

    il = []
    for line in inp.split("\n"):
        il.append(list(line))

    # for line in il:
    #     print('\"'+ "".join(line) +'\"')

    # il = [[".", ".", "^"],[".", ".", "."]]

    hl = len(il[0])
    vl = len(il)

    v, h = 0, 0
    facing = 0

    #0 up, 1 right, 2 down, 3 left

    for i in range(vl):
        for j in range(hl):
            if il[i][j] == "^":
                v = i
                h = j
                il[i][j] = "X"
                break

    faceil = [[[] for j in range(hl)] for i in range(vl)]
    # print(v, h)
    # print(faceil)
    ocount = 0
    ocountar = []

    def checkdirectsightandfacing(v, h, facing):
        if facing == 0:
            while v >= 0 and v < vl and h >= 0 and h < hl:
                if il[v][h] == "#":
                    return False
                elif il[v][h] == "X" and facing in faceil[v][h]:
                    return True
                v -= 1
        elif facing == 1:
            while v >= 0 and v < vl and h >= 0 and h < hl:
                if il[v][h] == "#":
                    return False
                elif il[v][h] == "X" and facing in faceil[v][h]:
                    return True
                h += 1
        elif facing == 2:
            while v >= 0 and v < vl and h >= 0 and h < hl:
                if il[v][h] == "#":
                    return False
                elif il[v][h] == "X" and facing in faceil[v][h]:
                    return True
                v += 1
        elif facing == 3:
            while v >= 0 and v < vl and h >= 0 and h < hl:
                if il[v][h] == "#":
                    return False
                elif il[v][h] == "X" and facing in faceil[v][h]:
                    return True
                h -= 1
        return False

    while v >= 0 and v < vl and h >= 0 and h < hl:
        if checkdirectsightandfacing(v, h, (facing + 1) % 4):
            if facing == 0:
                tempv = v - 1
                temph = h
            elif facing == 1:
                tempv = v
                temph = h + 1
            elif facing == 2:
                tempv = v + 1
                temph = h
            elif facing == 3:
                tempv = v
                temph = h - 1
            if [tempv, temph] not in ocountar and tempv >= 0 and tempv < vl and temph >= 0 and temph < hl:
                ocount += 1
                ocountar.append([tempv, temph])
        if il[v][h] =="X" and ((facing + 1) % 4) in faceil[v][h]:
            if facing == 0:
                tempv = v - 1
                temph = h
            elif facing == 1:
                tempv = v
                temph = h + 1
            elif facing == 2:
                tempv = v + 1
                temph = h
            elif facing == 3:
                tempv = v
                temph = h - 1
            if [tempv, temph] not in ocountar and tempv >= 0 and tempv < vl and temph >= 0 and temph < hl:
                ocount += 1
                ocountar.append([tempv, temph])
        if il[v][h] == "#":
            if facing == 0:
                v += 1 
            elif facing == 1:
                h -= 1
            elif facing == 2:
                v -= 1
            elif facing == 3:
                h += 1
            facing = (facing + 1) % 4
        else:
            il[v][h] = "X"
            faceil[v][h].append(facing)
            if facing == 0:
                v -= 1 
            elif facing == 1:
                h += 1
            elif facing == 2:
                v += 1
            elif facing == 3:
                h -= 1
        # print("\n\n il:")
        # print('\n'.join(['\t'.join([str(cell) for cell in row]) for row in il]))
        # print("\n faceil:")
        # print('\n'.join(['\t'.join([str(cell) for cell in row]) for row in faceil]))
        # print("\n ocountar:")
        # print('\n'.join(['\t'.join([str(cell) for cell in row]) for row in ocountar]))

    count = 0
    for line in il:
        for l in line:
            if l == "X":
                count += 1

    print(count)
    print(ocount)
    oarraycop = copy.deepcopy(il)

    for el in ocountar:
        oarraycop[el[0]][el[1]] = "O"
    # print('\n'.join(['\t'.join([str(cell) for cell in row]) for row in oarraycop]))
    # count Xs

    return oarraycop